<h1>Flights</h1>


<form method="post" action="./search">
  <p>Date:</p>
  <p><input type="date" name="flight_date"  value="2017-11-29"></p>
  <p>Departure: </p>
  <select name="departure_id" id="departure_select">
    <% @departures.each do |departure| %>
    <option value="<%= departure.id %>"><%= departure.departure_city %></option>
    <% end %>
  </select>
  <p>Destination:</p>
  <select name="destination_id" id="destination_select">
    <% @destinations.each do |destination| %>
    <option value="<%= destination.id %>"><%= destination.destination_city %></option>
    <% end %>
  </select>
  <p><input type="submit"></p>
</form>


<table>
  <tr>
    <th>Date</th>
    <th></th>
    <th>Number</th>
    <th></th>
    <th>Departure</th>
    <th></th>
    <th>Destination</th>
    <th></th>
    <th>Airline</th>
    <th></th>
    <th>Price</th>
  </tr>
  <% for flight in @results %>
  <% var1 = flight.available_seats.to_i%>
  <% var2 = flight.capacity.to_i%>
  <% var3 = flight.ticket_cost.to_i%>
  <tr>
    <td><%= flight.flight_date %></td>
    <td>|</td>
    <td><%= flight.flight_number %></td>
    <td>|</td>
    <td><%= flight.departure.departure_airport_name %></td>
    <td>|</td>
    <td><%= flight.destination.destination_airport_name %></td>
    <td>|</td>
    <td><%= flight.airline.airline_name %></td>
    <td>|</td>
    <td>Â£<%= (flight.flight_discount(var1, var2, var3) / 100).to_s %></td>
    <td>
    </td>
  </tr>
  <% end %>
  </table>
